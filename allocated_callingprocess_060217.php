<?php
require 'scripts/db_init.php';
main();
function main()
{
	$day = date("D");
	$time = date("G");
	if($day=="Sat" && $time >=21 )
	{}
	else
	{
		allocateplleadstoagents();
	}
}

function allocateplleadstoagents()
{
	$Dated = ExactServerdate();
	define('TABLE_REQ_LOAN_PERSONAL','Req_Loan_Personal');
	$currentdate = date('Y-m-d');
	//$currentdate="2016-06-01";
	$min_date = $currentdate." 00:00:00";
	$max_date = $currentdate." 23:59:59";
	//$max_date = "2016-06-01 23:59:59";
	
	$startprocess="Select total_lead_count From lead_allocation_table Where (Citywise='plmainlms' and BidderID=9999)";
	echo $startprocess."<br>";
	$startprocessresult = ExecQuery($startprocess);
	$recordcount = mysql_num_rows($startprocessresult);
	$row=mysql_fetch_array($startprocessresult);
	$total_lead_count = $row["total_lead_count"];
	
	if($total_lead_count>0)
	{
		echo $qryExcludeSourceSql = "SELECT * FROM manual_user_details where 1=1";
		$qryExcludeSourceQuery = ExecQuery($qryExcludeSourceSql);
		$numqryExcludeSourceQuery = mysql_num_rows($qryExcludeSourceQuery);
		$excludeSource = '';
		for($i=0;$i<$numqryExcludeSourceQuery;$i++)
		{
			$source_eS = mysql_result($qryExcludeSourceQuery,$i,'source');
			$excludeSource .= " and ".TABLE_REQ_LOAN_PERSONAL.".source!='".$source_eS."' ";
		}
		
		$qryExcludeSourceCallingSql = "SELECT * FROM exclude_source_calling where 1=1 and reply_type=1 and status=1";
		$qryExcludeSourceCallingQuery =ExecQuery($qryExcludeSourceCallingSql);;
		$qryExcludeSourceCallingNum = mysql_num_rows($qryExcludeSourceCallingQuery);
		$excludeSourceC = '';
		$excludeSourceC .= "( ".TABLE_REQ_LOAN_PERSONAL.".ex_source!='below60k' ";
		for($j=0;$j<$qryExcludeSourceCallingNum;$j++)
		{	
			$source_eSC =  mysql_result($qryExcludeSourceCallingQuery,$j,'source');
			$excludeSourceC .= " and ".TABLE_REQ_LOAN_PERSONAL.".source!='".$source_eSC."' ";
		}
		$excludeSourceC .= $excludeSource."  )";	
	

	
		$getActiveBiddersSql = "select BidderID from Bidders where leadidentifier='plmainlms' and Status=1 and BidderID !=2748";
		$getActiveBiddersQry = ExecQuery($getActiveBiddersSql);
		$recordCountActiveBidders = mysql_num_rows($getActiveBiddersQry);
		$BidderIDArr = '';
		$CheckBidderID = '';
		$counterVal = 1;
		for($i=0;$i<$recordCountActiveBidders;$i++)
		{
			$BidderID = mysql_result($getActiveBiddersQry,$i,'BidderID');
			$BidderIDArr[$counterVal] = $BidderID;
			$CheckBidderID[$counterVal] = $BidderID;
			$counterVal = $counterVal + 1;
		}

		/* Experts Agents */
		$getExpertsActiveBiddersSql = "select BidderID from Bidders where leadidentifier='plalloclms'";
		$getExpertsActiveBiddersQry = ExecQuery($getExpertsActiveBiddersSql);
		$recordExpertsCountActiveBidders = mysql_num_rows($getExpertsActiveBiddersQry);
		
		for($i=0;$i<$recordExpertsCountActiveBidders;$i++)
		{
			$BidderID = mysql_result($getExpertsActiveBiddersQry,$i,'BidderID');
			$CheckBidderID[$counterVal] = $BidderID;
			$counterVal= $counterVal+ 1;
		}
		/* Experts Agents */

		$BidderIDStr = implode(',', $CheckBidderID);
		
		$hour =  date("G");
		$day =  date("D");
		$minute = intval(date("i"));
		
			
		$plSql= "SELECT RequestID, Updated_Date, Net_Salary, Name FROM  Req_Loan_Personal WHERE  RequestID IN (2616791, 2616806, 2616809, 2616815, 2616826, 2616828, 2616844, 2616856, 2616862, 2616871, 2616872, 2616875, 2616901, 2616930, 2616932, 2616935, 2616967, 2616975, 2616976, 2616979, 2617044, 2617067, 2617082, 2617088, 2617100, 2617154, 2617157, 2617182, 2617209, 2617218, 2617236, 2617241, 2617273, 2617278, 2617295, 2617306, 2617333, 2617345, 2617397, 2617406, 2617446, 2617468, 2617512, 2617513, 2617520, 2617535, 2617568, 2617603, 2617608, 2617611, 2617655, 2617684, 2617702, 2617713, 2617731, 2617737, 2617777, 2617806, 2617873, 2617874, 2617925, 2617952, 2617975, 2617983, 2617993, 2617999, 2618001, 2618002, 2618013, 2618021, 2618023, 2618035, 2618068, 2618071, 2618100, 2618104, 2618113, 2618173, 2618192, 2618236, 2618262, 2618285, 2618298, 2618301, 2618342, 2618372, 2618373, 2618381, 2618384, 2618400, 2618408, 2618413, 2618414, 2618416, 2618418, 2618421, 2618434, 2618436, 2618437, 2618457, 2618460, 2618462, 2618471, 2618474, 2618476, 2618484, 2618496, 2618497, 2618503, 2618505, 2618510, 2618513, 2618518, 2618522, 2618523, 2618524, 2618535, 2618540, 2618542, 2618543, 2618544, 2618551, 2618553, 2618555, 2618557, 2618559, 2618561, 2618563, 2618566, 2618572, 2618574, 2618598, 2618599, 2618607, 2618611, 2618615, 2618617, 2618621, 2618627, 2618637, 2618640, 2618645, 2618646, 2618647, 2618652, 2618658, 2618661, 2618668, 2618674, 2618676, 2618683, 2618685, 2618696, 2618699, 2618702, 2618715, 2618726, 2618737, 2618746, 2618747, 2618750, 2618757, 2618760, 2618764, 2618765, 2618767, 2618768, 2618770, 2618771, 2618773, 2618774, 2618777, 2618778, 2618779, 2618783, 2618784, 2618789, 2618790, 2618794, 2618795, 2618796, 2618797, 2618799, 2618805, 2618807, 2618809, 2618811, 2618813, 2618820, 2618821, 2618822, 2618825, 2618833, 2618835, 2618836, 2618837, 2618838, 2618848, 2618851, 2618857, 2618860, 2618861, 2618862, 2618864, 2618866, 2618867, 2618868, 2618869, 2618870, 2618871, 2618873, 2618874, 2618880, 2618881, 2618882, 2618887, 2618888, 2618892, 2618896, 2618897, 2618899, 2618901, 2618904, 2618905, 2618910, 2618915, 2618916, 2618917, 2618921, 2618922, 2618923, 2618925, 2618929, 2618930, 2618932, 2618933, 2618939, 2618940, 2618941, 2618944, 2618948, 2618949, 2618950, 2618951, 2618952, 2618953, 2618958, 2618959, 2618960, 2618961, 2618962, 2618963, 2618964, 2618966, 2618969, 2618975, 2618977, 2618979, 2618980, 2618982, 2618986, 2618987, 2618988, 2618989, 2618990, 2618992, 2618993, 2618997, 2618999, 2619000, 2619001, 2619002, 2619003, 2619004, 2619006, 2619007, 2619013, 2619015, 2619016, 2619017, 2619018, 2619022, 2619024, 2619025, 2619026, 2619027, 2619028, 2619033, 2619037, 2619040, 2619043, 2619045, 2619047, 2619048, 2619050, 2619053, 2619055, 2619056, 2619059, 2619060, 2619061, 2619062, 2619065, 2619066, 2619068, 2619071, 2619072, 2619073, 2619074, 2619077, 2619080, 2619081, 2619082, 2619083, 2619085, 2619087, 2619088, 2619090, 2619092, 2619095, 2619097, 2619098, 2619099, 2619103, 2619104, 2619107, 2619108, 2619111, 2619112, 2619113, 2619115, 2619120, 2619122, 2619126, 2619128, 2619129, 2619131, 2619135, 2619136, 2619137, 2619139, 2619140, 2619142, 2619143, 2619145, 2619147, 2619150, 2619151, 2619152, 2619153, 2619155, 2619159, 2619160, 2619161, 2619162, 2619164, 2619165, 2619166, 2619168, 2619170, 2619171, 2619173, 2619174, 2619176, 2619177, 2619179, 2619181, 2619182, 2619183, 2619185, 2619187, 2619188, 2619190, 2619192, 2619194, 2619197, 2619198, 2619205, 2619207, 2619208, 2619210, 2619212, 2619213, 2619214, 2619215, 2619216, 2619218, 2619220, 2619222, 2619223, 2619224, 2619227, 2619232, 2619233, 2619235, 2619237, 2619238, 2619239, 2619240, 2619241, 2619244, 2619245, 2619247, 2619248, 2619249, 2619252, 2619253, 2619254, 2619256, 2619258, 2619260, 2619263, 2619267, 2619269, 2619274, 2619278, 2619281, 2619282, 2619285, 2619293, 2619294, 2619295, 2619296, 2619297, 2619299, 2619302, 2619303, 2619304, 2619305, 2619307, 2619309, 2619310, 2619311, 2619312, 2619315, 2619317, 2619318, 2619319, 2619321, 2619323, 2619324, 2619325, 2619326, 2619327, 2619331, 2619334, 2619335, 2619336, 2619344, 2619345, 2619347, 2619348, 2619349, 2619353, 2619355, 2619356, 2619359, 2619360, 2619361, 2619369, 2619373, 2619374, 2619378, 2619379, 2619383, 2619384, 2619385, 2619386, 2619387, 2619392, 2619393, 2619394, 2619398, 2619399, 2619400, 2619401, 2619404, 2619405, 2619407, 2619409, 2619412, 2619414, 2619419, 2619421, 2619422, 2619424, 2619425, 2619428, 2619429, 2619431, 2619435, 2619436, 2619437, 2619439, 2619440, 2619441, 2619442, 2619445, 2619447, 2619448, 2619456, 2619457, 2619458, 2619461, 2619463, 2619464, 2619465, 2619466, 2619467, 2619473, 2619475, 2619477, 2619478, 2619479, 2619480, 2619481, 2619482, 2619483, 2619484, 2619485, 2619488, 2619491, 2619492, 2619495, 2619496, 2619497, 2619499, 2619500, 2619501, 2619502, 2619503, 2619508, 2619512, 2619514, 2619516, 2619517, 2619518, 2619519, 2619522, 2619523, 2619525, 2619526, 2619527, 2619537, 2619540, 2619541, 2619542, 2619543, 2619544, 2619545, 2619546, 2619551, 2619552, 2619553, 2619554, 2619556, 2619557, 2619558, 2619560, 2619562, 2619563, 2619564, 2619571, 2619574, 2619575, 2619577, 2619578, 2619579, 2619582, 2619584, 2619586, 2619587, 2619589, 2619594, 2619596, 2619597, 2619598, 2619599, 2619600, 2619601, 2619602, 2619605, 2619606, 2619607, 2619611, 2619612, 2619613, 2619616, 2619621, 2619622, 2619625, 2619626, 2619627, 2619628, 2619630, 2619631, 2619632, 2619635, 2619636, 2619637, 2619638, 2619639, 2619641, 2619643, 2619645, 2619652, 2619654, 2619656, 2619657, 2619659, 2619660, 2619661, 2619662, 2619663, 2619664, 2619666, 2619667, 2619672, 2619676, 2619677, 2619678, 2619679, 2619680, 2619683, 2619684, 2619685, 2619686, 2619688, 2619690, 2619691, 2619697, 2619698, 2619699, 2619700, 2619702, 2619703, 2619704, 2619705, 2619707, 2619711, 2619712, 2619713, 2619714, 2619716, 2619720, 2619723, 2619724, 2619726, 2619727, 2619729, 2619730, 2619734, 2619735, 2619736, 2619737, 2619738, 2619739, 2619741, 2619742, 2619743, 2619746, 2619747, 2619748, 2619750, 2619751, 2619755, 2619756, 2619757, 2619759, 2619761, 2619762, 2619764, 2619765, 2619768, 2619769, 2619770, 2619773, 2619780, 2619781, 2619782, 2619785, 2619786, 2619787, 2619788, 2619789, 2619790, 2619793, 2619794, 2619808, 2619795, 2619797, 2619798, 2619799, 2619800, 2619801, 2619805, 2619806, 2619807, 2619810, 2619811, 2619812, 2619818, 2619821, 2619822, 2619823, 2619827, 2619828, 2619829, 2619835, 2619837, 2619840, 2619841, 2619846, 2619850, 2619851, 2619853, 2619856, 2619859, 2619861, 2619862, 2619863, 2619864, 2619865, 2619867, 2619868, 2619869, 2619871, 2619873, 2619874, 2619876, 2619877, 2619878, 2619879, 2619880, 2619882, 2619883, 2619889, 2619890, 2619892, 2619893, 2619894, 2619895, 2619898, 2619899, 2619903, 2619904, 2619905, 2619911, 2619913, 2619915, 2619919, 2619921, 2619922, 2619923, 2619924, 2619925, 2619926, 2619927, 2619928, 2619929, 2619938, 2619940, 2619944, 2619945, 2619947, 2619950, 2619951, 2619953, 2619954, 2619955, 2619956, 2619957, 2619958, 2619959, 2619960, 2619963, 2619964, 2619967, 2619969, 2619971, 2619973, 2619976, 2619977, 2619978, 2619982, 2619983, 2619987, 2619990, 2619992, 2619993, 2619994, 2619995, 2619996, 2619997, 2619999, 2620000, 2620002, 2620003, 2620007, 2620009, 2620010, 2620012, 2620013, 2620015, 2620020, 2620022, 2620023, 2620024, 2620025, 2620026, 2620027, 2620028, 2620031, 2620032, 2620037, 2620039, 2620041, 2620043, 2620044, 2620047, 2620053, 2620055, 2620059, 2620071, 2620073, 2620074, 2620075, 2620076, 2620077, 2620079, 2620080, 2620081, 2620082, 2620084, 2620085, 2620086, 2620089, 2620091, 2620092, 2620093, 2620094, 2620096, 2620099, 2620105, 2620106, 2620107, 2620110, 2620111, 2620113, 2620116, 2620117, 2620118, 2620119, 2620120, 2620121, 2620130, 2620131, 2620136, 2620137, 2620138, 2620140, 2620144, 2620145, 2620146, 2620147, 2620148, 2620149, 2620150, 2620151, 2620152, 2620153, 2620155, 2620157, 2620158, 2620160, 2620167, 2620168, 2620173, 2620176, 2620177, 2620178, 2620179, 2620181, 2620186, 2620187, 2620188, 2620189, 2620191, 2620192, 2620194, 2620196, 2620198, 2620199, 2620204, 2620205, 2620206, 2620207, 2620211, 2620213, 2620218, 2620219, 2620220, 2620227, 2620229, 2620234, 2620235, 2620237, 2620239, 2620242, 2620245, 2620248, 2620249, 2620250, 2620251, 2620252, 2620254, 2620258, 2620259, 2620260, 2620262, 2620265, 2620268, 2620270, 2620271, 2620273, 2620277, 2620280, 2620281, 2620282, 2620283, 2620284, 2620285, 2620292, 2620293, 2620296, 2620298, 2620300, 2620301, 2620302, 2620304, 2620305, 2620307, 2620310, 2620311, 2620312, 2620313, 2620314, 2620315, 2620317, 2620319, 2620320, 2620323, 2620325, 2620326, 2620328, 2620329, 2620331, 2620334, 2620335, 2620340, 2620342, 2620343, 2620344, 2620348, 2620349, 2620350, 2620351, 2620352, 2620353, 2620355, 2620357, 2620361, 2620362, 2620363, 2620365, 2620367, 2620370, 2620372, 2620373, 2620376, 2620377, 2620378, 2620383, 2620385, 2620387, 2620389, 2620390, 2620391, 2620393, 2620394, 2620396, 2620397, 2620398, 2620400, 2620404, 2620405, 2620406, 2620407, 2620408, 2620412, 2620413, 2620414, 2620419, 2620420, 2620421, 2620422, 2620423, 2620424, 2620428, 2620430, 2620432, 2620435, 2620436, 2620437, 2620438, 2620439, 2620440, 2620441, 2620442, 2620444, 2620445, 2620446, 2620448, 2620449, 2620450, 2620451, 2620453, 2620454, 2620456, 2620465, 2620466, 2620467, 2620468, 2620469, 2620470, 2620472, 2620474, 2620475, 2620481, 2620484, 2620485, 2620488, 2620489, 2620490, 2620491, 2620492, 2620494, 2620495, 2620496, 2620497, 2620500, 2620501, 2620503, 2620511, 2620513, 2620515) and RequestID not in (select AllRequestID from plcallinglms_allocation where AllRequestID in (2616791, 2616806, 2616809, 2616815, 2616826, 2616828, 2616844, 2616856, 2616862, 2616871, 2616872, 2616875, 2616901, 2616930, 2616932, 2616935, 2616967, 2616975, 2616976, 2616979, 2617044, 2617067, 2617082, 2617088, 2617100, 2617154, 2617157, 2617182, 2617209, 2617218, 2617236, 2617241, 2617273, 2617278, 2617295, 2617306, 2617333, 2617345, 2617397, 2617406, 2617446, 2617468, 2617512, 2617513, 2617520, 2617535, 2617568, 2617603, 2617608, 2617611, 2617655, 2617684, 2617702, 2617713, 2617731, 2617737, 2617777, 2617806, 2617873, 2617874, 2617925, 2617952, 2617975, 2617983, 2617993, 2617999, 2618001, 2618002, 2618013, 2618021, 2618023, 2618035, 2618068, 2618071, 2618100, 2618104, 2618113, 2618173, 2618192, 2618236, 2618262, 2618285, 2618298, 2618301, 2618342, 2618372, 2618373, 2618381, 2618384, 2618400, 2618408, 2618413, 2618414, 2618416, 2618418, 2618421, 2618434, 2618436, 2618437, 2618457, 2618460, 2618462, 2618471, 2618474, 2618476, 2618484, 2618496, 2618497, 2618503, 2618505, 2618510, 2618513, 2618518, 2618522, 2618523, 2618524, 2618535, 2618540, 2618542, 2618543, 2618544, 2618551, 2618553, 2618555, 2618557, 2618559, 2618561, 2618563, 2618566, 2618572, 2618574, 2618598, 2618599, 2618607, 2618611, 2618615, 2618617, 2618621, 2618627, 2618637, 2618640, 2618645, 2618646, 2618647, 2618652, 2618658, 2618661, 2618668, 2618674, 2618676, 2618683, 2618685, 2618696, 2618699, 2618702, 2618715, 2618726, 2618737, 2618746, 2618747, 2618750, 2618757, 2618760, 2618764, 2618765, 2618767, 2618768, 2618770, 2618771, 2618773, 2618774, 2618777, 2618778, 2618779, 2618783, 2618784, 2618789, 2618790, 2618794, 2618795, 2618796, 2618797, 2618799, 2618805, 2618807, 2618809, 2618811, 2618813, 2618820, 2618821, 2618822, 2618825, 2618833, 2618835, 2618836, 2618837, 2618838, 2618848, 2618851, 2618857, 2618860, 2618861, 2618862, 2618864, 2618866, 2618867, 2618868, 2618869, 2618870, 2618871, 2618873, 2618874, 2618880, 2618881, 2618882, 2618887, 2618888, 2618892, 2618896, 2618897, 2618899, 2618901, 2618904, 2618905, 2618910, 2618915, 2618916, 2618917, 2618921, 2618922, 2618923, 2618925, 2618929, 2618930, 2618932, 2618933, 2618939, 2618940, 2618941, 2618944, 2618948, 2618949, 2618950, 2618951, 2618952, 2618953, 2618958, 2618959, 2618960, 2618961, 2618962, 2618963, 2618964, 2618966, 2618969, 2618975, 2618977, 2618979, 2618980, 2618982, 2618986, 2618987, 2618988, 2618989, 2618990, 2618992, 2618993, 2618997, 2618999, 2619000, 2619001, 2619002, 2619003, 2619004, 2619006, 2619007, 2619013, 2619015, 2619016, 2619017, 2619018, 2619022, 2619024, 2619025, 2619026, 2619027, 2619028, 2619033, 2619037, 2619040, 2619043, 2619045, 2619047, 2619048, 2619050, 2619053, 2619055, 2619056, 2619059, 2619060, 2619061, 2619062, 2619065, 2619066, 2619068, 2619071, 2619072, 2619073, 2619074, 2619077, 2619080, 2619081, 2619082, 2619083, 2619085, 2619087, 2619088, 2619090, 2619092, 2619095, 2619097, 2619098, 2619099, 2619103, 2619104, 2619107, 2619108, 2619111, 2619112, 2619113, 2619115, 2619120, 2619122, 2619126, 2619128, 2619129, 2619131, 2619135, 2619136, 2619137, 2619139, 2619140, 2619142, 2619143, 2619145, 2619147, 2619150, 2619151, 2619152, 2619153, 2619155, 2619159, 2619160, 2619161, 2619162, 2619164, 2619165, 2619166, 2619168, 2619170, 2619171, 2619173, 2619174, 2619176, 2619177, 2619179, 2619181, 2619182, 2619183, 2619185, 2619187, 2619188, 2619190, 2619192, 2619194, 2619197, 2619198, 2619205, 2619207, 2619208, 2619210, 2619212, 2619213, 2619214, 2619215, 2619216, 2619218, 2619220, 2619222, 2619223, 2619224, 2619227, 2619232, 2619233, 2619235, 2619237, 2619238, 2619239, 2619240, 2619241, 2619244, 2619245, 2619247, 2619248, 2619249, 2619252, 2619253, 2619254, 2619256, 2619258, 2619260, 2619263, 2619267, 2619269, 2619274, 2619278, 2619281, 2619282, 2619285, 2619293, 2619294, 2619295, 2619296, 2619297, 2619299, 2619302, 2619303, 2619304, 2619305, 2619307, 2619309, 2619310, 2619311, 2619312, 2619315, 2619317, 2619318, 2619319, 2619321, 2619323, 2619324, 2619325, 2619326, 2619327, 2619331, 2619334, 2619335, 2619336, 2619344, 2619345, 2619347, 2619348, 2619349, 2619353, 2619355, 2619356, 2619359, 2619360, 2619361, 2619369, 2619373, 2619374, 2619378, 2619379, 2619383, 2619384, 2619385, 2619386, 2619387, 2619392, 2619393, 2619394, 2619398, 2619399, 2619400, 2619401, 2619404, 2619405, 2619407, 2619409, 2619412, 2619414, 2619419, 2619421, 2619422, 2619424, 2619425, 2619428, 2619429, 2619431, 2619435, 2619436, 2619437, 2619439, 2619440, 2619441, 2619442, 2619445, 2619447, 2619448, 2619456, 2619457, 2619458, 2619461, 2619463, 2619464, 2619465, 2619466, 2619467, 2619473, 2619475, 2619477, 2619478, 2619479, 2619480, 2619481, 2619482, 2619483, 2619484, 2619485, 2619488, 2619491, 2619492, 2619495, 2619496, 2619497, 2619499, 2619500, 2619501, 2619502, 2619503, 2619508, 2619512, 2619514, 2619516, 2619517, 2619518, 2619519, 2619522, 2619523, 2619525, 2619526, 2619527, 2619537, 2619540, 2619541, 2619542, 2619543, 2619544, 2619545, 2619546, 2619551, 2619552, 2619553, 2619554, 2619556, 2619557, 2619558, 2619560, 2619562, 2619563, 2619564, 2619571, 2619574, 2619575, 2619577, 2619578, 2619579, 2619582, 2619584, 2619586, 2619587, 2619589, 2619594, 2619596, 2619597, 2619598, 2619599, 2619600, 2619601, 2619602, 2619605, 2619606, 2619607, 2619611, 2619612, 2619613, 2619616, 2619621, 2619622, 2619625, 2619626, 2619627, 2619628, 2619630, 2619631, 2619632, 2619635, 2619636, 2619637, 2619638, 2619639, 2619641, 2619643, 2619645, 2619652, 2619654, 2619656, 2619657, 2619659, 2619660, 2619661, 2619662, 2619663, 2619664, 2619666, 2619667, 2619672, 2619676, 2619677, 2619678, 2619679, 2619680, 2619683, 2619684, 2619685, 2619686, 2619688, 2619690, 2619691, 2619697, 2619698, 2619699, 2619700, 2619702, 2619703, 2619704, 2619705, 2619707, 2619711, 2619712, 2619713, 2619714, 2619716, 2619720, 2619723, 2619724, 2619726, 2619727, 2619729, 2619730, 2619734, 2619735, 2619736, 2619737, 2619738, 2619739, 2619741, 2619742, 2619743, 2619746, 2619747, 2619748, 2619750, 2619751, 2619755, 2619756, 2619757, 2619759, 2619761, 2619762, 2619764, 2619765, 2619768, 2619769, 2619770, 2619773, 2619780, 2619781, 2619782, 2619785, 2619786, 2619787, 2619788, 2619789, 2619790, 2619793, 2619794, 2619808, 2619795, 2619797, 2619798, 2619799, 2619800, 2619801, 2619805, 2619806, 2619807, 2619810, 2619811, 2619812, 2619818, 2619821, 2619822, 2619823, 2619827, 2619828, 2619829, 2619835, 2619837, 2619840, 2619841, 2619846, 2619850, 2619851, 2619853, 2619856, 2619859, 2619861, 2619862, 2619863, 2619864, 2619865, 2619867, 2619868, 2619869, 2619871, 2619873, 2619874, 2619876, 2619877, 2619878, 2619879, 2619880, 2619882, 2619883, 2619889, 2619890, 2619892, 2619893, 2619894, 2619895, 2619898, 2619899, 2619903, 2619904, 2619905, 2619911, 2619913, 2619915, 2619919, 2619921, 2619922, 2619923, 2619924, 2619925, 2619926, 2619927, 2619928, 2619929, 2619938, 2619940, 2619944, 2619945, 2619947, 2619950, 2619951, 2619953, 2619954, 2619955, 2619956, 2619957, 2619958, 2619959, 2619960, 2619963, 2619964, 2619967, 2619969, 2619971, 2619973, 2619976, 2619977, 2619978, 2619982, 2619983, 2619987, 2619990, 2619992, 2619993, 2619994, 2619995, 2619996, 2619997, 2619999, 2620000, 2620002, 2620003, 2620007, 2620009, 2620010, 2620012, 2620013, 2620015, 2620020, 2620022, 2620023, 2620024, 2620025, 2620026, 2620027, 2620028, 2620031, 2620032, 2620037, 2620039, 2620041, 2620043, 2620044, 2620047, 2620053, 2620055, 2620059, 2620071, 2620073, 2620074, 2620075, 2620076, 2620077, 2620079, 2620080, 2620081, 2620082, 2620084, 2620085, 2620086, 2620089, 2620091, 2620092, 2620093, 2620094, 2620096, 2620099, 2620105, 2620106, 2620107, 2620110, 2620111, 2620113, 2620116, 2620117, 2620118, 2620119, 2620120, 2620121, 2620130, 2620131, 2620136, 2620137, 2620138, 2620140, 2620144, 2620145, 2620146, 2620147, 2620148, 2620149, 2620150, 2620151, 2620152, 2620153, 2620155, 2620157, 2620158, 2620160, 2620167, 2620168, 2620173, 2620176, 2620177, 2620178, 2620179, 2620181, 2620186, 2620187, 2620188, 2620189, 2620191, 2620192, 2620194, 2620196, 2620198, 2620199, 2620204, 2620205, 2620206, 2620207, 2620211, 2620213, 2620218, 2620219, 2620220, 2620227, 2620229, 2620234, 2620235, 2620237, 2620239, 2620242, 2620245, 2620248, 2620249, 2620250, 2620251, 2620252, 2620254, 2620258, 2620259, 2620260, 2620262, 2620265, 2620268, 2620270, 2620271, 2620273, 2620277, 2620280, 2620281, 2620282, 2620283, 2620284, 2620285, 2620292, 2620293, 2620296, 2620298, 2620300, 2620301, 2620302, 2620304, 2620305, 2620307, 2620310, 2620311, 2620312, 2620313, 2620314, 2620315, 2620317, 2620319, 2620320, 2620323, 2620325, 2620326, 2620328, 2620329, 2620331, 2620334, 2620335, 2620340, 2620342, 2620343, 2620344, 2620348, 2620349, 2620350, 2620351, 2620352, 2620353, 2620355, 2620357, 2620361, 2620362, 2620363, 2620365, 2620367, 2620370, 2620372, 2620373, 2620376, 2620377, 2620378, 2620383, 2620385, 2620387, 2620389, 2620390, 2620391, 2620393, 2620394, 2620396, 2620397, 2620398, 2620400, 2620404, 2620405, 2620406, 2620407, 2620408, 2620412, 2620413, 2620414, 2620419, 2620420, 2620421, 2620422, 2620423, 2620424, 2620428, 2620430, 2620432, 2620435, 2620436, 2620437, 2620438, 2620439, 2620440, 2620441, 2620442, 2620444, 2620445, 2620446, 2620448, 2620449, 2620450, 2620451, 2620453, 2620454, 2620456, 2620465, 2620466, 2620467, 2620468, 2620469, 2620470, 2620472, 2620474, 2620475, 2620481, 2620484, 2620485, 2620488, 2620489, 2620490, 2620491, 2620492, 2620494, 2620495, 2620496, 2620497, 2620500, 2620501, 2620503, 2620511, 2620513, 2620515)) ";
		
		
	//	$plSql= "SELECT RequestID, Updated_Date, Net_Salary, Name FROM  Req_Loan_Personal WHERE  RequestID IN ( 2618760, 2618764, 2618765)";	
	//		$plSql= "SELECT RequestID, Updated_Date, Net_Salary, Name FROM  Req_Loan_Personal WHERE  RequestID IN (2618757)";	
		echo $plSql;
		echo "<br>";
	
		$plQry = ExecQuery($plSql);
		$recordCount = mysql_num_rows($plQry);
		$bidderID = "";
		echo $recordCount."<br>";
	
	//exit();
		for($i=0;$i<$recordCount;$i++)	
		{
			$AllRequestID = mysql_result($plQry,$i,'RequestID');
			$Allocation_Date = mysql_result($plQry,$i,'Updated_Date');
			$DOE = mysql_result($plQry,$i,'Updated_Date');
			$Net_Salary = mysql_result($plQry,$i,'Net_Salary');
			if($AllRequestID>0)
			{
				if($Net_Salary>60000)
				{
					$sequenceid=ExecQuery("Select last_allocated_to,total_no_agents From lead_allocation_table Where (Citywise='plmainlms' and BidderID=9999)");
					$seqid = mysql_fetch_array($sequenceid);
					$last_allocated_to = $seqid["last_allocated_to"];
					$total_no_agents = $seqid["total_no_agents"];
					
					if($total_no_agents>$last_allocated_to)
					{
						$sequence=$last_allocated_to+1;
					}
					else
					{
						$sequence=1;
					}	
					$getCheckSQl = "select * from plcallinglms_allocation where AllRequestID = '".$AllRequestID."' and BidderID in (".$BidderIDStr.")  ";
					$getCheckQuery = ExecQuery($getCheckSQl);
					$getCheckNum = mysql_num_rows($getCheckQuery);
					if($getCheckNum>0)
					{
						//Already Existing Lead
					}
					else
					{				
						$bidderID = $BidderIDArr[$sequence];
						if($AllRequestID>0 && $bidderID>1)
						{
							//insert allocation
							echo "<br>*******************************************<br>";
							echo $inserticiciqry="INSERT INTO plcallinglms_allocation (AllRequestID, BidderID, Allocation_Date, DOE) VALUES ('".$AllRequestID."', '".$bidderID."', '".$Dated."', '".$DOE."')";
							$inserticiciqryresult = ExecQuery($inserticiciqry);
							echo "<br>";
							echo $updateqry= "Update lead_allocation_table set last_allocated_to='".$sequence."' , total_lead_count='".$AllRequestID."' Where (Citywise='plmainlms' and BidderID=9999)";
							$updateqryresult = ExecQuery($updateqry);
							echo "<br>";
						}				
					}
					$getCheckNum = '';
				}
				else
				{
					$bidderID = 2748;
					echo "<br>*******************************************<br>";
					echo $inserticiciqry="INSERT INTO plcallinglms_allocation (AllRequestID, BidderID, Allocation_Date, DOE) VALUES ('".$AllRequestID."', '".$bidderID."', '".$Dated."', '".$DOE."')";
					$inserticiciqryresult = ExecQuery($inserticiciqry);
					echo "<br>";
					echo $updateqry= "Update lead_allocation_table set total_lead_count='".$AllRequestID."' Where (Citywise='plmainlms' and BidderID=9999)";
					$updateqryresult = ExecQuery($updateqry);
					echo "<br>";
				
				}
			}
		}
	}
}
?>